<h1>Tell us about your restaurant:</h1>
<hr>
<br>
<div id="smartwizard" class="formTab">
    <ul class="nav">
        <li>
            <a class="nav-link" href="#step-1">
                Enter Restaurant Details
            </a>
        </li>
        <li>
            <a class="nav-link" href="#step-2">
                Enter Links For Socials
            </a>
        </li>
        <li>
            <a class="nav-link" href="#step-3">
                Add Icon For Restaurant
            </a>
        </li>
    </ul>
    <form action="/staffRestaurant/createRestaurant" method="post" id="createRestaurant">
        <div class="tab-content formTab">
            <!-- Restaurant name and tag -->
            <div id="step-1" class="tab-pane" role="tabpanel">
                <div class="input-group mb-3">
                    <input type="text" id="name" name="name" class="form-control" placeholder="Restaurant Name"
                        aria-label="Restaurant Name" />
                    <span class="input-group-text" style="height: 35px;">@</span>
                    <input type="text" id="tag" class="form-control" placeholder="Tag" aria-label="Tag" />
                    <input type="hidden" id="res_name" name="res_name" class="form-control"/>
                </div>

                <!-- Company Email -->
                <div class="form-outline mb-4">
                    <input type="email" id="comp_email" name="comp_email" class="form-control" />
                    <label class="form-label" for="comp_email">Public Company Email</label>
                </div>
                <!-- Cuisine -->
                <select class="form-select" id="cuisine" name="cuisine">
                    <option selected>Cuisine</option>
                    <option value="Western">Western</option>
                    <option value="Mexican">Mexican</option>
                    <option value="Thai">Thai</option>
                    <option value="Indian">Indian</option>
                    <option value="Japanese">Japanese</option>
                    <option value="French">French</option>
                    <option value="Chinese">Chinese</option>
                    <option value="Italian">Italian</option>
                    <option value="Seafood">Seafood</option>
                    <option value="Local">Local</option>
                </select>
                <br>
                <!-- Opening and Closing Hours -->
                <div class="form_group">
                    <label for="open_time">Opening Hours:</label>
                    <input type='text' name="open_time" class="form-control" id="open_time" />
                </div>
                <br>
                <div class="form-group">
                    <label for="close_time">Closing Hours:</label>
                    <input type='text' name="close_time" class="form-control" id="close_time" />
                </div>
                <br>
                <!-- Halal -->
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value=1 id="halal" name="halal">
                    <label class="form-check-label" for="halal">
                        Halal
                    </label>
                </div>
            </div>
            <div id="step-2" class="tab-pane" role="tabpanel">
                <!-- Facebook Link -->
                <div class="form-outline mb-4">
                    <input type="text" id="facebook" name="facebook" class="form-control" />
                    <label class="form-label" for="facebook">Facebook account url</label>
                </div>
                <div class="form-outline mb-4">
                    <input type="text" id="twitter" name="twitter" class="form-control" />
                    <label class="form-label" for="twitter">Twitter account url</label>
                </div>
                <div class="form-outline mb-4">
                    <input type="text" id="instagram" name="instagram" class="form-control" />
                    <label class="form-label" for="instagram">Instagram account url</label>
                </div>
            </div>
            <div id="step-3" class="tab-pane" role="tabpanel">
                <div>
                    <input type="file" id="restaurantIcon" name="restaurantIcon"
                        accept="image/png,image/jpeg,image/jpg,image/gif">
                    <img id="icon" src="/img/no-image.jpg" alt="" class="border img-thumbnail img-fluid">
                    <input id="iconURL" type="hidden" name="iconURL">
                    <div class="font-weight-bold text-danger small" id="iconErr" style="display:none"></div>
                    <button class="btn btn-primary btn-block">Submit</button>
                </div>
            </div>
        </div>
    </form>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
<link href="https://cdn.jsdelivr.net/npm/smartwizard@5/dist/css/smart_wizard_all.min.css" rel="stylesheet"
    type="text/css" />
<script src="https://cdn.jsdelivr.net/npm/smartwizard@5/dist/js/jquery.smartWizard.min.js"
    type="text/javascript"></script>

<script>
    $("#name").on("change", function (){
        $("#res_name").val($("#name").val() + "@" + $("#tag").val())
    })
    $("#tag").on("change", function (){
        $("#res_name").val($("#name").val() + "@" + $("#tag").val())
    })
    $("#restaurantIcon").on("change", function () {
        let image = $("#restaurantIcon")[0].files[0];
        let formdata = new FormData();
        formdata.append("restaurantIcon", image);
        $.ajax({
            url: "/staffRestaurant/upload",
            type: "POST",
            data: formdata,
            contentType: false,
            processData: false,
            success: (data) => {
                $("#icon").attr("src", data.file);
                $("#iconURL").val(data.file); // sets iconURL hidden field
                if (data.err) {
                    $("#iconErr").show();
                    $("#iconErr").text(data.err.message);
                } else {
                    $("#iconErr").hide();
                }
            },
        });
    });

    $(function () {
        $('#open_time').timepicker
            ({
                format: 'HH:MM',
                uiLibrary: 'bootstrap4',
            });
        $('#close_time').timepicker
            ({
                format: 'HH:MM',
                uiLibrary: 'bootstrap4',
            });
        $('#smartwizard').smartWizard({
            theme: "dots",
            transition: {
                animation: "slide-horizontal",
                speed: "400",
            },
        });
        $('.sw-btn-next').attr("id", "submit");
        $("#smartwizard").on("leaveStep", function (e, anchorObject, currentStepIndex, nextStepIndex, stepDirection) {
            if (anchorObject.prevObject.length - 1 == nextStepIndex) {
                $('#submit').html("Submit<i class='fas fa-paper-plane'></i>");
                $('#submit').click(() => {
                    $('#submit').submit("createRestaurant")
                })
                $("#submit").removeClass();
                $("#submit").addClass("btn sw-btn-prev ripple-surface")
            } else {
                $('#submit').text("Next");
                $('#submit').attr("type", "button")
            }
        });
    });
</script>